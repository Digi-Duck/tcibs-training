<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        
    </style>
</head>
<body>
    <!-- <img src="./偶宜/355444166_2383384408516696_5094676170250400530_n.jpg" alt=""> -->
    <canvas id="myCanvas"></canvas>
    <!-- <img src="../19.speadtest/img/he.jpg" alt=""> -->
    <a class="a" href="">dafadfdassfadf</a>
    <script>
        a();
        function a() {
            const canvas = document.getElementById('myCanvas');
            const ctx = canvas.getContext('2d');

            // 在 canvas 上繪製圖像
            const image = new Image();
            img.src = './img/he.jpg';

            canvas.width = image.width;
            canvas.height = image.width;

            image.onload = function () {
                
                ctx.drawImage(image,0,0);
                

                // 加躁點
                const iData = ctx.getImageData(0,0,image.width,image.height);

                for (let i = 0; i < iData.data.length; i += 4) {
                    total = iData.data[i] + iData.data[i+1] +iData.data[i+2];
                    if(total > 112){
                        iData.data[i] += 255;
                        iData.data[i + 1] += 255;
                        iData.data[i + 2] += 255;
                    }else{
                        iData.data[i] += 0;
                        iData.data[i + 1] += 0;
                        iData.data[i + 2] += 0;
                    }


                    // iData.data[i] += Math.floor(Math.random() * 100);
                    // iData.data[i + 1] += Math.floor(Math.random() * 100);
                    // iData.data[i + 2] += Math.floor(Math.random() * 100);
                }

                // ctx.font = '24px Arial';
                // ctx.fillStyle = 'gray';
                // ctx.textAlign = 'center';

                // const text = 'plane';
                // const x = 0;
                // const y = 0;


                // for (index = 0; index < 100; index++) {
                //     for (i = 0; i < 100; i++) {
                //         ctx.fillText(text,x + i *100,y + index *100);
                        
                //     }
                // }
                
                // ctx.putImageData(image,0,0);
                ctx.putImageData(iData,0,0);

                const dataURL = canvas.toDataURL(); // 獲取圖片的 base64 編碼
    
                // 創建一個下載連結元素
                // const link = document.createElement('a');
                // link.href = dataURL;
                // link.download = 'canvas_image.png'; // 下載檔案的名稱
                // 模擬點擊下載連結
                // link.click();

                const link = document.querySelector('.a');
                link.href = dataURL;
                link.download = 'canvas_image.png'; // 下載檔案的名稱
                
            }

            // 將 canvas 轉換為圖片檔案

        }
    </script>
</body>
</html>